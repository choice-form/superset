import React, { createRef, forwardRef } from 'react';
import { styled } from 'src/core';
import type { CustomFunnelProps, CustomFunnelStylesProps } from './types';
import './CustomFunnel.less';
import { toRGBA } from '../ECharts/utils/colors';

const Styles = styled.div<CustomFunnelStylesProps>`
  height: ${({ height }) => height};
  width: ${({ width }) => width};
`;

const FunnelSVG = ({ model }: any) => (
  <svg
    className="funnel-svg"
    width="100%"
    height="100%"
    xmlns="http://www.w3.org/2000/svg"
    viewBox="0 0 497 399"
  >
    <path
      d="M0 0L45.8213 78.2984H426.489L472.311 3.58996e-06L0 0Z"
      fill="#AA00FF"
    />
    <text className="layer" textAnchor="middle" transform="translate(236 38)">
      {model[0].map((part: string, index: number) => (
        <tspan x="0" dy={index ? '1.2em' : '0'}>
          {part}
        </tspan>
      ))}
    </text>
    <path
      d="M425.08 80.4436H47.2311L93.1379 158.742H379.173L425.08 80.4436Z"
      fill="#DF2020"
    />
    <text className="layer" textAnchor="middle" transform="translate(236 116)">
      {model[1].map((part: string, index: number) => (
        <tspan x="0" dy={index ? '1.2em' : '0'}>
          {part}
        </tspan>
      ))}
    </text>
    <path
      d="M377.849 160.887H94.4622L140.513 238.113H331.798L377.849 160.887Z"
      fill="#FFBF00"
    />
    <text className="layer" textAnchor="middle" transform="translate(236 194)">
      {model[2].map((part: string, index: number) => (
        <tspan x="0" dy={index ? '1.2em' : '0'}>
          {part}
        </tspan>
      ))}
    </text>
    <path
      d="M329.544 240.258H142.767L188.58 318.556H283.731L329.544 240.258Z"
      fill="#33CC59"
    />
    <text className="layer" textAnchor="middle" transform="translate(236 272)">
      {model[3].map((part: string, index: number) => (
        <tspan x="0" dy={index ? '1.2em' : '0'}>
          {part}
        </tspan>
      ))}
    </text>
    <path
      d="M282.313 320.702H189.998L236.156 399L282.313 320.702Z"
      fill="#0055FF"
    />
    <text className="layer" textAnchor="middle" transform="translate(236 350)">
      {model[4].map((part: string, index: number) => (
        <tspan x="0" dy={index ? '1.2em' : '0'}>
          {part}
        </tspan>
      ))}
    </text>
    <path
      d="M25.4361 183.995V188.577H30.4082V183.995H25.4361ZM29.5323 187.792H26.2991V184.793H29.5323V187.792ZM33.0747 181.176H22.7439V192.001H23.6456V191.447H32.173V192.001H33.0747V181.176ZM23.6456 190.623V182H32.173V190.623H23.6456ZM35.5092 189.658C36.4882 189.401 37.4414 189.117 38.3431 188.796V192.129H39.2576V180.468H38.3431V187.895C37.699 188.139 37.0549 188.358 36.4109 188.538V181.511H35.5092V188.564C35.5092 188.693 35.4062 188.796 35.2258 188.873L35.5092 189.658ZM41.8854 183.274H44.4745C44.3972 185.05 43.985 186.595 43.2122 187.908C42.4651 186.852 41.8725 185.694 41.4088 184.432C41.5763 184.072 41.7308 183.686 41.8854 183.274ZM40.8678 185.436C41.3315 186.62 41.9369 187.714 42.6583 188.744C41.8596 189.8 40.7776 190.662 39.4251 191.331L39.9532 192.168C41.2929 191.447 42.3878 190.559 43.2379 189.491C44.0494 190.495 45.0155 191.421 46.1362 192.258L46.7674 191.511C45.6338 190.688 44.6549 189.748 43.8047 188.693C44.7579 187.2 45.2732 185.385 45.3633 183.274H46.4711V182.36H42.1688C42.3234 181.794 42.4651 181.176 42.5939 180.52L41.6664 180.365C41.2929 182.63 40.5715 184.445 39.5153 185.784L40.0949 186.492C40.3654 186.17 40.623 185.822 40.8678 185.436ZM48.1328 181.485V182.36H52.8731C52.4609 183.197 51.9199 183.815 51.25 184.214L51.4304 184.96C52.1775 184.909 52.8988 184.844 53.5944 184.793C52.7958 185.694 52.1131 186.312 51.5463 186.633L51.2114 186.711L51.3917 187.521C52.01 187.47 52.6026 187.418 53.1951 187.354V188.744H47.9396V189.632H53.1951V192.258H54.1483V189.632H59.4296V188.744H54.1483V187.238C54.5734 187.187 54.9985 187.122 55.4107 187.045C55.5137 187.315 55.6296 187.612 55.7327 187.92L56.57 187.547C56.2608 186.698 55.8873 185.9 55.4622 185.153L54.6764 185.411C54.8181 185.694 54.9598 186.003 55.1144 186.337C54.3415 186.466 53.5429 186.582 52.7185 186.685C53.6459 185.913 54.7408 184.741 55.9774 183.171L55.153 182.836C54.8439 183.248 54.5476 183.634 54.2514 184.008L52.5639 184.162C53.0276 183.699 53.4527 183.094 53.8263 182.36H59.2106V181.485H54.1354C53.9551 181.022 53.7619 180.623 53.5558 180.262L52.6154 180.417C52.8344 180.738 53.0276 181.099 53.208 181.485H48.1328ZM50.284 185.359C49.6785 186.067 48.9958 186.685 48.2487 187.213L48.867 187.908C49.6012 187.367 50.3097 186.698 50.9795 185.874L50.284 185.359ZM49.0087 182.798L48.3646 183.416C49.1375 183.969 49.7558 184.497 50.1938 184.999L50.8378 184.355C50.3484 183.84 49.7301 183.313 49.0087 182.798ZM57.0852 185.359L56.4927 185.925C57.3171 186.62 57.9611 187.29 58.4249 187.908L59.0947 187.238C58.5537 186.62 57.8839 185.99 57.0852 185.359ZM58.09 182.759C57.5876 183.351 57.0337 183.879 56.4154 184.329L56.9951 184.999C57.6262 184.535 58.2317 183.969 58.8113 183.287L58.09 182.759ZM26.4151 199.963L21.7778 206.064V207.068H26.4022V209.153H27.4069V207.068H28.9011V206.206H27.4069V199.963H26.4151ZM26.3635 201.341H26.4022V206.206H22.6666L26.3635 201.341ZM30.8927 207.622C30.6608 207.622 30.4805 207.699 30.3388 207.853C30.1842 208.008 30.1069 208.188 30.1069 208.42C30.1069 208.638 30.1842 208.819 30.3388 208.973C30.4805 209.127 30.6608 209.205 30.8927 209.205C31.0988 209.205 31.292 209.127 31.4466 208.973C31.6011 208.819 31.6784 208.638 31.6784 208.42C31.6784 208.188 31.6011 208.008 31.4466 207.853C31.292 207.699 31.0988 207.622 30.8927 207.622ZM35.5515 199.963C35.2423 200.311 34.8817 200.62 34.4437 200.903C34.0057 201.16 33.5678 201.341 33.1556 201.456V202.512C34.0186 202.254 34.74 201.843 35.3196 201.25V209.153H36.3759V199.963H35.5515ZM47.2781 204.121C46.5825 204.121 46.0544 204.365 45.6937 204.88C45.3588 205.318 45.2042 205.91 45.2042 206.643C45.2042 207.364 45.3588 207.943 45.6937 208.407C46.0544 208.896 46.5825 209.153 47.2781 209.153C47.9608 209.153 48.4889 208.896 48.8625 208.407C49.1845 207.956 49.352 207.364 49.352 206.643C49.352 205.91 49.1845 205.318 48.8625 204.88C48.4889 204.365 47.9608 204.121 47.2781 204.121ZM46.1703 199.783L41.005 209.333H41.8422L46.9947 199.783H46.1703ZM40.7345 199.963C40.0389 199.963 39.5108 200.208 39.1501 200.723C38.8152 201.16 38.6606 201.752 38.6606 202.486C38.6606 203.207 38.8152 203.786 39.1501 204.249C39.5108 204.738 40.0389 204.996 40.7345 204.996C41.4172 204.996 41.9453 204.738 42.3189 204.249C42.6409 203.799 42.8083 203.207 42.8083 202.486C42.8083 201.752 42.6409 201.16 42.3189 200.723C41.9453 200.208 41.4172 199.963 40.7345 199.963ZM47.2781 204.816C47.6646 204.816 47.9479 204.996 48.1412 205.369C48.2957 205.678 48.3859 206.103 48.3859 206.643C48.3859 207.171 48.2957 207.583 48.1412 207.892C47.9479 208.265 47.6646 208.458 47.2781 208.458C46.8788 208.458 46.5954 208.265 46.4151 207.905C46.2476 207.596 46.1703 207.171 46.1703 206.643C46.1703 206.09 46.2476 205.665 46.4151 205.356C46.5954 204.996 46.8788 204.816 47.2781 204.816ZM40.7345 200.658C41.1209 200.658 41.4043 200.839 41.5846 201.212C41.7521 201.521 41.8422 201.945 41.8422 202.486C41.8422 203.014 41.7521 203.426 41.5975 203.735C41.4043 204.108 41.1209 204.301 40.7345 204.301C40.3351 204.301 40.0518 204.108 39.8714 203.747C39.704 203.439 39.6267 203.014 39.6267 202.486C39.6267 201.933 39.704 201.508 39.8714 201.199C40.0518 200.839 40.3351 200.658 40.7345 200.658Z"
      fill="black"
    />
    <path
      d="M64.406 113.815L61.3073 116.911L64.406 120.008L67.5048 116.911L64.406 113.815ZM64.406 279.944H63.8693V280.48H64.406V279.944ZM167.456 279.944L162.089 276.847V283.04L167.456 279.944ZM63.8693 116.911V279.944H64.9428V116.911H63.8693ZM64.406 280.48H162.625V279.407H64.406V280.48Z"
      fill="#999999"
    />
    <path
      d="M454.063 35.5166L457.162 38.6129L454.063 41.7092L450.964 38.6129L454.063 35.5166ZM454.063 116.911H454.599V117.448H454.063V116.911ZM402.538 116.911L407.905 113.815V120.008L402.538 116.911ZM454.599 38.6129V116.911H453.526V38.6129H454.599ZM454.063 117.448H407.368V116.375H454.063V117.448Z"
      fill="#999999"
    />
    <path
      d="M463.779 63.84V67.2766H465.067V68.0231H463.354V68.7052H465.067V69.5418H462.981V70.2626H464.9C464.449 70.7775 463.766 71.2151 462.839 71.5755L463.29 72.3091C463.625 72.1418 463.947 71.9616 464.23 71.7814C464.668 72.0646 465.016 72.3477 465.299 72.618L465.789 72.1032C465.518 71.8457 465.196 71.5883 464.836 71.3309C465.209 71.0091 465.518 70.6487 465.776 70.2626H467.863C468.043 70.5844 468.288 70.9062 468.597 71.2408C468.275 71.5368 467.901 71.8071 467.489 72.0388L467.927 72.618C468.365 72.3606 468.764 72.0646 469.125 71.7299C469.421 71.9873 469.782 72.2576 470.207 72.5279L470.774 71.82C469.834 71.3566 469.138 70.8418 468.687 70.2626H470.542V69.5418H468.597V68.7052H470.323V68.0231H468.597V67.2766H469.846V63.84H463.779ZM465.905 69.5418V68.7052H467.76V69.5418H465.905ZM465.905 68.0231V67.2766H467.76V68.0231H465.905ZM469.035 66.6201H464.591V65.8607H469.035V66.6201ZM464.591 65.2687V64.5093H469.035V65.2687H464.591ZM466.343 75.2437C466.961 75.2437 467.27 74.9348 467.27 74.3427V70.7388H466.368V74.1368C466.368 74.3556 466.253 74.4714 466.046 74.4714C465.763 74.4714 465.48 74.4457 465.171 74.4199L465.364 75.2437H466.343ZM465.724 72.8111C464.952 73.2487 464.037 73.6091 462.955 73.918L463.316 74.716C464.346 74.3427 465.209 73.918 465.905 73.4546L465.724 72.8111ZM467.992 72.9398L467.592 73.5318C468.417 73.8794 469.215 74.3556 469.988 74.9734L470.465 74.2397C469.718 73.7378 468.893 73.3002 467.992 72.9398ZM460.263 69.1686H461.667V72.219H460.263V69.1686ZM461.667 68.3191H460.263V65.2172H461.667V68.3191ZM462.504 64.3806H459.4V74.0595H460.263V73.0685H462.504V64.3806ZM477.202 63.5054V68.2805H472.062V69.1943H475.566V69.2844C475.54 70.6101 475.257 71.6913 474.741 72.515C474.174 73.313 473.196 73.9437 471.779 74.4328L472.307 75.2566C473.762 74.7546 474.819 74.0596 475.463 73.1586C476.12 72.1804 476.467 70.8933 476.506 69.2844V69.1943H478.683V73.6992C478.683 74.5358 479.069 74.9605 479.868 74.9605H481.877C482.393 74.9605 482.766 74.8318 482.998 74.5744C483.256 74.2912 483.436 73.4675 483.526 72.1032L482.637 71.82C482.586 72.9269 482.483 73.5833 482.328 73.815C482.199 73.9952 481.993 74.0853 481.71 74.0853H480.151C479.791 74.0853 479.61 73.8922 479.61 73.5061V69.1943H483.307V68.2805H478.155V63.5054H477.202ZM481.478 64.1232C481.053 65.1271 480.486 66.1568 479.778 67.1865L480.615 67.6112C481.324 66.6201 481.903 65.5905 482.341 64.535L481.478 64.1232ZM473.917 64.239L473.041 64.6509C473.672 65.5261 474.278 66.5043 474.844 67.6112L475.707 67.1865C475.141 66.1182 474.548 65.14 473.917 64.239ZM485.02 64.5736V65.4489H489.761C489.349 66.2855 488.808 66.9033 488.138 67.3023L488.318 68.0488C489.065 67.9973 489.787 67.933 490.482 67.8815C489.683 68.7825 489.001 69.4003 488.434 69.722L488.099 69.7993L488.279 70.6101C488.898 70.5586 489.49 70.5072 490.083 70.4428V71.8329H484.827V72.721H490.083V75.3466H491.036V72.721H496.317V71.8329H491.036V70.327C491.461 70.2755 491.886 70.2111 492.298 70.1339C492.401 70.4042 492.517 70.7002 492.62 71.0091L493.458 70.6359C493.149 69.7864 492.775 68.9884 492.35 68.2419L491.564 68.4993C491.706 68.7825 491.847 69.0914 492.002 69.426C491.229 69.5547 490.431 69.6706 489.606 69.7735C490.534 69.0013 491.629 67.83 492.865 66.2597L492.041 65.9251C491.732 66.337 491.435 66.7231 491.139 67.0964L489.452 67.2508C489.915 66.7875 490.34 66.1825 490.714 65.4489H496.098V64.5736H491.023C490.843 64.1103 490.65 63.7113 490.443 63.3509L489.503 63.5054C489.722 63.8271 489.915 64.1875 490.096 64.5736H485.02ZM487.172 68.4478C486.566 69.1557 485.883 69.7735 485.136 70.3012L485.755 70.9963C486.489 70.4557 487.197 69.7864 487.867 68.9626L487.172 68.4478ZM485.896 65.8865L485.252 66.5043C486.025 67.0577 486.644 67.5855 487.081 68.0874L487.725 67.4439C487.236 66.929 486.618 66.4013 485.896 65.8865ZM493.973 68.4478L493.38 69.0141C494.205 69.7092 494.849 70.3785 495.313 70.9963L495.982 70.327C495.441 69.7092 494.772 69.0785 493.973 68.4478ZM494.978 65.8479C494.475 66.4399 493.921 66.9676 493.303 67.4181L493.883 68.0874C494.514 67.6241 495.119 67.0577 495.699 66.3756L494.978 65.8479ZM462.311 82.8719C461.435 82.8719 460.727 83.1164 460.186 83.6184C459.619 84.1204 459.284 84.8154 459.207 85.7035H460.25C460.314 85.0857 460.52 84.6095 460.881 84.2748C461.229 83.9402 461.705 83.7857 462.324 83.7857C462.916 83.7857 463.393 83.9273 463.728 84.2362C464.037 84.5194 464.204 84.9184 464.204 85.4332C464.204 85.948 464.037 86.347 463.715 86.6302C463.393 86.9005 462.929 87.0421 462.311 87.0421H461.602V87.8658H462.35C462.994 87.8658 463.483 88.0074 463.844 88.3163C464.204 88.6252 464.385 89.0499 464.385 89.6034C464.385 90.144 464.192 90.5945 463.831 90.9548C463.432 91.3281 462.903 91.5212 462.246 91.5212C461.667 91.5212 461.19 91.3538 460.804 91.0449C460.353 90.6717 460.108 90.1182 460.082 89.3975H459.013C459.091 90.4271 459.451 91.2123 460.108 91.7528C460.662 92.1905 461.371 92.4221 462.246 92.4221C463.2 92.4221 463.973 92.1518 464.565 91.6113C465.145 91.0836 465.441 90.4014 465.441 89.5648C465.441 89.0242 465.286 88.5737 464.977 88.2133C464.694 87.8529 464.282 87.5955 463.741 87.4282C464.745 87.0936 465.248 86.3985 465.248 85.3688C465.248 84.5966 464.977 83.9916 464.449 83.5412C463.908 83.0907 463.187 82.8719 462.311 82.8719ZM466.518 83.0521V84.0174H471.477L468.051 92.2419H469.171L472.559 83.9144V83.0521H466.518ZM474.825 90.7103C474.593 90.7103 474.413 90.7875 474.271 90.942C474.117 91.0964 474.039 91.2766 474.039 91.5083C474.039 91.7271 474.117 91.9073 474.271 92.0617C474.413 92.2162 474.593 92.2934 474.825 92.2934C475.031 92.2934 475.224 92.2162 475.379 92.0617C475.533 91.9073 475.611 91.7271 475.611 91.5083C475.611 91.2766 475.533 91.0964 475.379 90.942C475.224 90.7875 475.031 90.7103 474.825 90.7103ZM480.282 82.8719C479.381 82.8719 478.634 83.1679 478.054 83.7728C477.461 84.3649 477.178 85.1114 477.178 86.0253C477.178 86.9134 477.436 87.6341 477.964 88.1876C478.505 88.7668 479.213 89.0628 480.102 89.0628C480.643 89.0628 481.12 88.9212 481.532 88.6638C481.957 88.3935 482.292 88.0203 482.524 87.5569H482.575C482.575 87.7114 482.588 87.8272 482.588 87.8916C482.588 88.9212 482.382 89.7836 481.983 90.4657C481.558 91.1736 480.991 91.534 480.282 91.534C479.2 91.534 478.569 91.0063 478.376 89.9638H477.333C477.577 91.5984 478.556 92.4221 480.269 92.4221C481.3 92.4221 482.124 91.933 482.743 90.9806C483.309 90.0539 483.606 88.8697 483.606 87.4025C483.606 85.9866 483.335 84.8797 482.794 84.1075C482.227 83.2837 481.39 82.8719 480.282 82.8719ZM480.308 83.76C480.939 83.76 481.455 83.9788 481.841 84.4164C482.214 84.8283 482.408 85.356 482.408 85.9995C482.408 86.6302 482.202 87.1579 481.815 87.5698C481.403 87.9816 480.901 88.1876 480.308 88.1876C479.664 88.1876 479.162 87.9816 478.788 87.5826C478.402 87.1965 478.221 86.6688 478.221 86.0253C478.221 85.356 478.402 84.8154 478.788 84.3906C479.175 83.9659 479.677 83.76 480.308 83.76ZM493.764 87.2094C493.068 87.2094 492.54 87.4539 492.179 87.9688C491.844 88.4064 491.69 88.9985 491.69 89.7321C491.69 90.4529 491.844 91.0321 492.179 91.4954C492.54 91.9845 493.068 92.2419 493.764 92.2419C494.446 92.2419 494.974 91.9845 495.348 91.4954C495.67 91.0449 495.837 90.4529 495.837 89.7321C495.837 88.9985 495.67 88.4064 495.348 87.9688C494.974 87.4539 494.446 87.2094 493.764 87.2094ZM492.656 82.8719L487.49 92.4221H488.328L493.48 82.8719H492.656ZM487.22 83.0521C486.524 83.0521 485.996 83.2966 485.636 83.8115C485.301 84.2491 485.146 84.8411 485.146 85.5748C485.146 86.2955 485.301 86.8747 485.636 87.3381C485.996 87.8272 486.524 88.0846 487.22 88.0846C487.903 88.0846 488.431 87.8272 488.804 87.3381C489.126 86.8876 489.294 86.2955 489.294 85.5748C489.294 84.8411 489.126 84.2491 488.804 83.8115C488.431 83.2966 487.903 83.0521 487.22 83.0521ZM493.764 87.9044C494.15 87.9044 494.433 88.0846 494.627 88.4579C494.781 88.7668 494.871 89.1915 494.871 89.7321C494.871 90.2598 494.781 90.6717 494.627 90.9806C494.433 91.3538 494.15 91.5469 493.764 91.5469C493.364 91.5469 493.081 91.3538 492.901 90.9935C492.733 90.6845 492.656 90.2598 492.656 89.7321C492.656 89.1787 492.733 88.7539 492.901 88.445C493.081 88.0846 493.364 87.9044 493.764 87.9044ZM487.22 83.7471C487.606 83.7471 487.89 83.9273 488.07 84.3006C488.238 84.6095 488.328 85.0342 488.328 85.5748C488.328 86.1025 488.238 86.5144 488.083 86.8233C487.89 87.1965 487.606 87.3896 487.22 87.3896C486.821 87.3896 486.537 87.1965 486.357 86.8361C486.189 86.5272 486.112 86.1025 486.112 85.5748C486.112 85.0213 486.189 84.5966 486.357 84.2877C486.537 83.9273 486.821 83.7471 487.22 83.7471Z"
      fill="black"
    />
    <path
      d="M403.611 121.323L406.71 124.419L403.611 127.516L400.512 124.419L403.611 121.323ZM403.611 202.718H404.148V203.254H403.611V202.718ZM352.086 202.718L357.454 199.621V205.814L352.086 202.718ZM404.148 124.419V202.718H403.075V124.419H404.148ZM403.611 203.254H356.917V202.181H403.611V203.254Z"
      fill="#999999"
    />
    <path
      d="M413.676 148.252V152.01H410.172V156.142H418.699V152.01H414.59V150.376H419.588V149.501H414.59V148.252H413.676ZM417.772 155.28H411.1V152.886H417.772V155.28ZM410.146 156.708C409.683 157.764 409.129 158.678 408.485 159.437L409.245 159.99C409.889 159.167 410.443 158.201 410.932 157.082L410.146 156.708ZM412.954 157.082L412.091 157.262C412.336 158.073 412.542 158.999 412.723 160.055L413.65 159.849C413.444 158.858 413.212 157.931 412.954 157.082ZM415.647 156.953L414.771 157.133C415.157 157.97 415.479 158.935 415.737 160.029L416.651 159.823C416.368 158.793 416.033 157.828 415.647 156.953ZM418.287 156.695L417.54 157.172C418.326 158.227 418.944 159.18 419.395 160.055L420.168 159.514C419.73 158.716 419.112 157.777 418.287 156.695ZM422.538 150.131V151.019H426.75V153.156H421.546V154.057H426.75V158.6H423.723V155.177H422.834V160.055H423.723V159.463H430.743V160.055H431.632V155.177H430.743V158.6H427.703V154.057H432.92V153.156H427.703V151.019H431.864V150.131H427.703V148.316H426.75V150.131H422.538ZM434.569 149.308V150.183H439.309C438.897 151.019 438.356 151.637 437.686 152.036L437.867 152.783C438.614 152.731 439.335 152.667 440.031 152.615C439.232 153.516 438.549 154.134 437.983 154.456L437.648 154.533L437.828 155.344C438.446 155.293 439.039 155.241 439.631 155.177V156.567H434.376V157.455H439.631V160.081H440.585V157.455H445.866V156.567H440.585V155.061C441.01 155.009 441.435 154.945 441.847 154.868C441.95 155.138 442.066 155.434 442.169 155.743L443.006 155.37C442.697 154.52 442.324 153.722 441.898 152.976L441.113 153.233C441.254 153.516 441.396 153.825 441.551 154.16C440.778 154.289 439.979 154.404 439.155 154.507C440.082 153.735 441.177 152.564 442.414 150.994L441.589 150.659C441.28 151.071 440.984 151.457 440.688 151.83L439 151.985C439.464 151.521 439.889 150.916 440.263 150.183H445.647V149.308H440.572C440.391 148.844 440.198 148.445 439.992 148.085L439.052 148.239C439.271 148.561 439.464 148.921 439.644 149.308H434.569ZM436.72 153.182C436.115 153.89 435.432 154.507 434.685 155.035L435.303 155.73C436.038 155.19 436.746 154.52 437.416 153.697L436.72 153.182ZM435.445 150.62L434.801 151.238C435.574 151.792 436.192 152.319 436.63 152.821L437.274 152.178C436.785 151.663 436.166 151.135 435.445 150.62ZM443.522 153.182L442.929 153.748C443.753 154.443 444.397 155.112 444.861 155.73L445.531 155.061C444.99 154.443 444.32 153.812 443.522 153.182ZM444.526 150.582C444.024 151.174 443.47 151.702 442.852 152.152L443.431 152.821C444.063 152.358 444.668 151.792 445.248 151.109L444.526 150.582ZM408.343 167.786V168.751H413.302L409.876 176.976H410.996L414.384 168.648V167.786H408.343ZM416.649 175.444C416.418 175.444 416.238 175.521 416.096 175.676C415.942 175.83 415.864 176.01 415.864 176.242C415.864 176.461 415.942 176.641 416.096 176.796C416.238 176.95 416.418 177.027 416.649 177.027C416.856 177.027 417.05 176.95 417.204 176.796C417.359 176.641 417.436 176.461 417.436 176.242C417.436 176.01 417.359 175.83 417.204 175.676C417.05 175.521 416.856 175.444 416.649 175.444ZM423.293 167.786L418.655 173.887V174.891H423.28V176.976H424.285V174.891H425.779V174.028H424.285V167.786H423.293ZM423.241 169.163H423.28V174.028H419.544L423.241 169.163ZM435.589 171.943C434.893 171.943 434.365 172.188 434.004 172.703C433.67 173.14 433.515 173.732 433.515 174.466C433.515 175.187 433.67 175.766 434.004 176.229C434.365 176.718 434.893 176.976 435.589 176.976C436.272 176.976 436.8 176.718 437.173 176.229C437.495 175.779 437.663 175.187 437.663 174.466C437.663 173.732 437.495 173.14 437.173 172.703C436.8 172.188 436.272 171.943 435.589 171.943ZM434.481 167.606L429.316 177.156H430.153L435.305 167.606H434.481ZM429.045 167.786C428.35 167.786 427.821 168.03 427.461 168.545C427.126 168.983 426.971 169.575 426.971 170.309C426.971 171.029 427.126 171.609 427.461 172.072C427.821 172.561 428.35 172.818 429.045 172.818C429.728 172.818 430.256 172.561 430.63 172.072C430.952 171.621 431.119 171.029 431.119 170.309C431.119 169.575 430.952 168.983 430.63 168.545C430.256 168.03 429.728 167.786 429.045 167.786ZM435.589 172.638C435.975 172.638 436.259 172.818 436.452 173.192C436.606 173.501 436.697 173.925 436.697 174.466C436.697 174.994 436.606 175.406 436.452 175.714C436.259 176.088 435.975 176.281 435.589 176.281C435.19 176.281 434.906 176.088 434.726 175.727C434.558 175.418 434.481 174.994 434.481 174.466C434.481 173.913 434.558 173.488 434.726 173.179C434.906 172.818 435.19 172.638 435.589 172.638ZM429.045 168.481C429.432 168.481 429.715 168.661 429.895 169.034C430.063 169.343 430.153 169.768 430.153 170.309C430.153 170.836 430.063 171.248 429.908 171.557C429.715 171.93 429.432 172.123 429.045 172.123C428.646 172.123 428.362 171.93 428.182 171.57C428.015 171.261 427.937 170.836 427.937 170.309C427.937 169.755 428.015 169.33 428.182 169.022C428.362 168.661 428.646 168.481 429.045 168.481Z"
      fill="black"
    />
    <path
      d="M311.296 276.847L314.395 279.944L311.296 283.04L308.197 279.944L311.296 276.847ZM311.296 358.242H311.833V358.778H311.296V358.242ZM259.771 358.242L265.138 355.145V361.338L259.771 358.242ZM311.833 279.944V358.242H310.759V279.944H311.833ZM311.296 358.778H264.602V357.706H311.296V358.778Z"
      fill="#999999"
    />
    <path
      d="M326.358 304.381H317.715V315.566H318.655V314.704H325.431V315.54H326.358V304.381ZM318.655 313.803V311.383H325.431V313.803H318.655ZM318.655 310.534V308.268H325.431V310.534H318.655ZM318.655 307.419V305.282H325.431V307.419H318.655ZM330.931 303.789V306.222H329.36V307.11H330.931C330.532 308.732 329.875 310.186 328.947 311.447L329.347 312.451C329.991 311.447 330.519 310.34 330.931 309.131V315.54H331.846V309.092C332.232 309.581 332.683 310.225 333.211 311.036L333.739 310.25C333.108 309.465 332.477 308.744 331.846 308.101V307.11H333.34V306.222H331.846V303.789H330.931ZM334.731 309.607C334.37 311.203 333.791 312.644 332.992 313.944L333.791 314.459C334.564 313.146 335.169 311.602 335.581 309.8L334.731 309.607ZM339.394 309.542L338.557 309.813C339.059 311.203 339.523 312.786 339.948 314.575L340.785 314.202C340.399 312.554 339.935 310.997 339.394 309.542ZM336.509 315.412C337.256 315.412 337.642 315.026 337.642 314.266V308.539H340.798V307.65H333.572V308.539H336.715V314.034C336.715 314.408 336.534 314.601 336.187 314.601C335.813 314.601 335.427 314.575 335.015 314.549L335.195 315.412H336.509ZM334.255 304.523V305.398H340.128V304.523H334.255ZM353.241 305.128H348.308C348.153 304.613 347.986 304.162 347.818 303.751L346.775 303.931C346.955 304.291 347.11 304.69 347.265 305.128H342.318V308.011H343.258V306.029H352.301V308.011H353.241V305.128ZM344.16 307.522V308.423H351.374V307.522H344.16ZM342.189 309.941V310.83H345.757V310.92C345.719 311.924 345.448 312.734 344.933 313.352C344.366 313.957 343.387 314.433 341.983 314.794L342.511 315.618C343.954 315.219 344.997 314.665 345.642 313.97C346.286 313.198 346.633 312.181 346.672 310.92V310.83H348.836V314.073C348.836 314.923 349.222 315.36 350.021 315.36H352.198C352.636 315.36 352.945 315.231 353.151 315C353.383 314.742 353.538 313.983 353.615 312.747L352.739 312.464C352.688 313.442 352.61 314.022 352.507 314.215C352.417 314.382 352.262 314.472 352.031 314.472H350.317C349.944 314.472 349.763 314.266 349.763 313.88V310.83H353.409V309.941H342.189ZM363.817 303.712L363.224 304.278C363.881 304.78 364.397 305.256 364.783 305.72H362.374C362.348 305.102 362.336 304.446 362.336 303.725H361.382C361.382 304.42 361.395 305.076 361.421 305.72H356.101V310.006C356.062 312.104 355.637 313.738 354.813 314.923L355.521 315.553C356.475 314.163 356.99 312.31 357.041 310.006V309.62H359.27C359.244 311.035 359.205 311.962 359.128 312.4C359.051 312.76 358.87 312.953 358.587 312.966C358.239 312.966 357.814 312.953 357.312 312.928L357.595 313.764C358.007 313.79 358.381 313.816 358.69 313.816C359.334 313.79 359.734 313.507 359.901 312.953C360.068 312.323 360.171 310.92 360.197 308.744H357.041V306.608H361.46C361.563 308.217 361.743 309.568 362.026 310.649C362.168 311.203 362.336 311.718 362.516 312.194C361.627 313.314 360.532 314.163 359.244 314.742L359.759 315.515C360.97 314.974 362.026 314.189 362.928 313.133C363.121 313.532 363.34 313.893 363.572 314.202C364.19 314.974 364.77 315.36 365.311 315.36C365.891 315.36 366.329 314.498 366.638 312.786L365.801 312.323C365.607 313.648 365.388 314.318 365.157 314.33C364.899 314.33 364.551 314.022 364.126 313.404C363.92 313.108 363.727 312.747 363.546 312.335C364.371 311.177 365.041 309.736 365.556 308.037L364.719 307.676C364.319 309.053 363.804 310.263 363.16 311.293C363.07 311.01 362.98 310.714 362.902 310.392C362.67 309.465 362.503 308.204 362.413 306.608H366.38V305.72H364.809L365.401 305.128C364.963 304.652 364.435 304.175 363.817 303.712ZM368.016 304.832V305.707H372.756C372.344 306.544 371.803 307.161 371.133 307.56L371.314 308.307C372.061 308.255 372.782 308.191 373.478 308.14C372.679 309.04 371.996 309.658 371.43 309.98L371.095 310.057L371.275 310.868C371.893 310.817 372.486 310.765 373.078 310.701V312.091H367.823V312.979H373.078V315.605H374.032V312.979H379.313V312.091H374.032V310.585C374.457 310.534 374.882 310.469 375.294 310.392C375.397 310.662 375.513 310.958 375.616 311.267L376.453 310.894C376.144 310.044 375.771 309.246 375.346 308.5L374.56 308.757C374.702 309.041 374.843 309.349 374.998 309.684C374.225 309.813 373.426 309.929 372.602 310.032C373.529 309.259 374.624 308.088 375.861 306.518L375.036 306.183C374.727 306.595 374.431 306.981 374.135 307.354L372.447 307.509C372.911 307.046 373.336 306.441 373.71 305.707H379.094V304.832H374.019C373.838 304.368 373.645 303.969 373.439 303.609L372.499 303.763C372.718 304.085 372.911 304.446 373.091 304.832H368.016ZM370.167 308.706C369.562 309.414 368.879 310.032 368.132 310.559L368.75 311.254C369.485 310.714 370.193 310.044 370.863 309.221L370.167 308.706ZM368.892 306.145L368.248 306.762C369.021 307.316 369.639 307.844 370.077 308.345L370.721 307.702C370.232 307.187 369.613 306.659 368.892 306.145ZM376.969 308.706L376.376 309.272C377.2 309.967 377.845 310.636 378.308 311.254L378.978 310.585C378.437 309.967 377.767 309.337 376.969 308.706ZM377.973 306.106C377.471 306.698 376.917 307.226 376.299 307.676L376.878 308.345C377.51 307.882 378.115 307.316 378.695 306.634L377.973 306.106ZM318.552 323.31C318.243 323.658 317.882 323.967 317.445 324.25C317.007 324.507 316.569 324.687 316.156 324.803V325.859C317.019 325.601 317.741 325.189 318.32 324.597V332.5H319.377V323.31H318.552ZM324.624 323.13C323.516 323.13 322.691 323.606 322.138 324.584C321.648 325.408 321.403 326.515 321.403 327.905C321.403 329.295 321.648 330.402 322.138 331.226C322.691 332.191 323.516 332.68 324.624 332.68C325.719 332.68 326.543 332.191 327.11 331.226C327.599 330.402 327.844 329.295 327.844 327.905C327.844 326.515 327.599 325.408 327.11 324.584C326.543 323.606 325.719 323.13 324.624 323.13ZM324.624 324.031C325.448 324.031 326.041 324.468 326.401 325.357C326.659 325.974 326.801 326.824 326.801 327.905C326.801 328.973 326.659 329.823 326.401 330.454C326.041 331.329 325.448 331.779 324.624 331.779C323.799 331.779 323.207 331.329 322.846 330.454C322.588 329.823 322.46 328.973 322.46 327.905C322.46 326.824 322.588 325.974 322.846 325.357C323.207 324.468 323.799 324.031 324.624 324.031ZM332.348 323.13C331.24 323.13 330.416 323.606 329.862 324.584C329.373 325.408 329.128 326.515 329.128 327.905C329.128 329.295 329.373 330.402 329.862 331.226C330.416 332.191 331.24 332.68 332.348 332.68C333.443 332.68 334.267 332.191 334.834 331.226C335.324 330.402 335.568 329.295 335.568 327.905C335.568 326.515 335.324 325.408 334.834 324.584C334.267 323.606 333.443 323.13 332.348 323.13ZM332.348 324.031C333.172 324.031 333.765 324.468 334.126 325.357C334.383 325.974 334.525 326.824 334.525 327.905C334.525 328.973 334.383 329.823 334.126 330.454C333.765 331.329 333.172 331.779 332.348 331.779C331.524 331.779 330.931 331.329 330.57 330.454C330.313 329.823 330.184 328.973 330.184 327.905C330.184 326.824 330.313 325.974 330.57 325.357C330.931 324.468 331.524 324.031 332.348 324.031ZM345.726 327.467C345.031 327.467 344.503 327.712 344.142 328.227C343.807 328.664 343.652 329.257 343.652 329.99C343.652 330.711 343.807 331.29 344.142 331.753C344.503 332.243 345.031 332.5 345.726 332.5C346.409 332.5 346.937 332.243 347.311 331.753C347.633 331.303 347.8 330.711 347.8 329.99C347.8 329.257 347.633 328.664 347.311 328.227C346.937 327.712 346.409 327.467 345.726 327.467ZM344.619 323.13L339.453 332.68H340.29L345.443 323.13H344.619ZM339.183 323.31C338.487 323.31 337.959 323.555 337.598 324.07C337.263 324.507 337.109 325.099 337.109 325.833C337.109 326.554 337.263 327.133 337.598 327.596C337.959 328.085 338.487 328.343 339.183 328.343C339.865 328.343 340.393 328.085 340.767 327.596C341.089 327.146 341.257 326.554 341.257 325.833C341.257 325.099 341.089 324.507 340.767 324.07C340.393 323.555 339.865 323.31 339.183 323.31ZM345.726 328.162C346.113 328.162 346.396 328.343 346.589 328.716C346.744 329.025 346.834 329.45 346.834 329.99C346.834 330.518 346.744 330.93 346.589 331.239C346.396 331.612 346.113 331.805 345.726 331.805C345.327 331.805 345.044 331.612 344.863 331.251C344.696 330.943 344.619 330.518 344.619 329.99C344.619 329.437 344.696 329.012 344.863 328.703C345.044 328.343 345.327 328.162 345.726 328.162ZM339.183 324.005C339.569 324.005 339.852 324.185 340.033 324.559C340.2 324.868 340.29 325.292 340.29 325.833C340.29 326.361 340.2 326.772 340.046 327.081C339.852 327.455 339.569 327.648 339.183 327.648C338.783 327.648 338.5 327.455 338.32 327.094C338.152 326.785 338.075 326.361 338.075 325.833C338.075 325.279 338.152 324.855 338.32 324.546C338.5 324.185 338.783 324.005 339.183 324.005Z"
      fill="black"
    />
  </svg>
);
export const CustomFunnel = forwardRef((props: CustomFunnelProps) => {
  const rootElem = createRef<HTMLDivElement>();
  const {
    model,
    radius,
    titleText,
    titleFontColor,
    titleFontSize,
    titleFontWeight,
    height,
    width,
  } = props;

  // const config = useMemo(
  //   () => ({
  //     percent: percentage,
  //     outline: {
  //       border: 2,
  //       distance: 4,
  //     },
  //     shape,
  //     wave: {
  //       length: 128,
  //     },
  //     width,
  //     height,
  //     autoFit: false,
  //   }),
  //   [height, width, percentage, shape],
  // );

  return (
    <Styles ref={rootElem} height={height} width={width}>
      {titleText && (
        <p
          style={{
            color: toRGBA(titleFontColor),
            fontSize: `${titleFontSize}px`,
            fontWeight: titleFontWeight,
          }}
        >
          {titleText}
        </p>
      )}
      <div style={{ height, width, padding: `${radius / 2}%` }}>
        <FunnelSVG model={model} />
      </div>
    </Styles>
  );
});

export default CustomFunnel;
